# 安全第一

Tobey Maguire
> “我是一个空白的石板 - 因此我可以创造任何我想要的东西。”

如果说有一个章节是目前大多数黑客书籍和博客文章所忽视的，那就是在黑客攻击过程中如何“保持安全”。换句话说，典型的黑客通过何种方案和技术保持一定程度的匿名性和安全性，他们没有具体介绍。虽然你可能是世界上最牛X的黑客，但如果无法有效在互联网上隐藏自己，等待你的，就只有被抓这条路了。

因此，在尝试新技术之前，我们将详细介绍如何叠加多层安全措施，以最大程度“保护”自己。如果您想立即开始黑客攻击，请直接跳转到第3节，但请确保后面会安排时间阅读此部分。

## 空白的石板
最有效的黑客安全规则可以用七个词来概括：“每次都从头开始”。 “从头开始”意味着每次黑客攻击都要：获得一台新计算机、新热点、新IP地址和新服务器。 调查人员将寻找攻击之间的共同模式。他们尝试将碎片化的证据拼凑成一幅完整而清晰的图景。典型的，他们会思考这些问题：这个IP我们在其他攻击中是不是见过？ 当时使用的哪款浏览器[1]？ 它访问了哪个Gmail / Yahoo / Microsoft / Facebook帐户？

在进行调查时，不要认为执法机构是在独自工作。 他们可以访问大量的信息，从您当地的互联网服务提供商的记录一直到社交网站。 要想了解政府（美国，法国，加拿大，英国等）进行的大规模监视项目，请查看爱德华·斯诺登的故事[2]，不要太震惊哦。

每次重新开始，可以让自己在调查人员收集的线索里像“谜”一样的存在，防止他们将线索组合起来追溯到你的真实身份。

## 网络匿名
空白石板原则第一条：永远不要使用您的家庭/学校/工作 IP。 决不！ 即便对其做了两层匿名处理，也不要这么做。 总是假设在某种情况下，系统中的一个小故障可能会以某种方式将您的真实IP泄露给调查员：例如您忽视的某个小细节、某些技术的限制，或 NSA 的超级大国智能系统。 与现实世界的任何一个微小连接，就会激励调查人员深入挖掘下去，发布调查函，并最终迫使你承认。我们不希望这样。

### 第一层 - 混合
那你应该使用哪种IP？ 我强烈推荐公共Wi-Fi热点，如快餐店（星巴克，奥林巴斯，麦当劳等）或大型公共聚会场所，如商场，火车站等，只要有足够的人可以让你从可能的摄像头中隐藏起来。

访问Wi-Fi热点时，他们可能会要求您提供个人信息，你可以胡乱伪造一份。 如果他们要求进行手机验证，请选择其他地点，或使用现金支付支付的预付费SIM卡， 如果您办法弄到的话。

如果他们要求邮件账户确认，请使用“Yopmail.com”帐户。 这是一个可以在两秒钟内访问邮箱的网站，对验证链接和垃圾邮件非常有用。

### 第二层 - 像'斗士'一样走私数据
第二层的黑客安全措施，是目前最重要的一层。它通常由一个隧道网络组成，对在其中传播的所有内容进行加密，并且绝不记录访问IP地址。

TOR [3]是一个免费的开源项目可以实现这点。 它是一个交换加密信息的服务器网络。 例如，一个网络请求从你在法国的电脑发起，进入TOR网络，经过多次加密，从位于中国的服务器发出，才到达最终目标（Facebook，Twitter等）。

[Tor 网络结构](./1-1TorStructure.jpg)

被访问的服务（Facebook）无法看到原始IP地址;他们只看到退出节点的IP地址。 由于多用户共用此退出节点，因此很快就会让后面的调查人员感到困惑。

第一个节点知道您的真实IP地址（以及您的真实位置），但不知道您的请求最终会使用哪个出口节点。最重要的是，如果使用SSL [4]（HTTPS）检索网页，则第一个节点将无法再查看您的请求内容，只能看到Facebook的IP地址。

由于有大量节点可用于跳转用户请求，所以同时踩到恶意入口和出口节点的概率很低。虽然这是事实，但仍然有办法打破用户的匿名性，这已被证明是非常有效的。

想象一个恶意网站，它将代码注入您的TOR网络浏览器。这段代码安装恶意软件，该恶意软件向政府控制的网站发送普通请求（不通过TOR）。这直接将TOR提供的每一层保护消除掉了。这种情况完全属于情报机构或重要公司的范畴。

此外，长期以来一直有传言说，一些联邦机构控制着TOR网络上的大量节点，因此可以关联不同的信息和统计数据，以便精准识别TOR用户;提防这项服务的局限性。

如果TOR不是你的最佳选择，那么另一种方式是寻找VPN提供商 - 最好是付费的[5]，这样你就可以确保一定的质量水平。

虚拟专用网络（VPN）是两台或多台机器之间的加密网络。VPN提供商在您的工作站与其中一台服务器之间搭建了隧道。您从浏览器发出的任何请求都将通过该服务器，在此过程中隐藏您的真实IP地址。

[双层架构](./1-2TorWithVpnStructure.jpg)

计算机的每个请求都是加密的。 您当地的ISP不会知道您要发送的流量或您正在联系的IP地址，这对绕过政府机构部署的审查程序非常有用。
 
当然，在这种设置中，VPN提供商就成了最薄弱的环节。 它知道您的原始IP地址，从而知道您的位置（如果您使用信用卡付款，它甚至知道您的名字）。 但是，某些VPN服务可确保其服务器托管在大多数执法机构中立的国家/地区，并对服务器上发生的事件不做日志记录。 有关示例，请查看https://www.privacytools.io/。

###	第三层 - 最后一站
回顾一下，我们连接到公共热点并通过TOR或VPN服务器发出所有请求。

您可能觉得这样已经完美了，但这种设置存在一个主要问题：带宽太慢，无法执行真正的攻击。 此外，IP 掩码技术将导致后续介绍的某些工具和技术难以使用（端口扫描和反弹shell，仅列出一些举例）。

这下轮到我们的终极武器登场了：直接连接到互联网的虚拟专用服务器（VPS）。 我们将通过低带宽链路控制这台服务器，并指示它使用可支配的大带宽向目标发出大量请求：

[最终架构图](./1-3FinalStructure.jpg)

这台VPS，在这里称为“Front Gun”服务器，通过比特币支付。[6] （或任何其他匿名加密货币）。 事实上，没有什么比信用卡的数据更容易被溯源。 您可以在以下URL找到接受比特币的提供商列表[7]。

此服务器可以托管您习惯的任何操作系统。比如说，你可以安装KALI[8]。系统中与安装了很多顺手的工具，可以省去一些麻烦。我个人的话，更倾向于同时拥有Windows和Linux机器，以保持最大的灵活性。 实现此目的的一种方法是安装一台Windows机器，在虚拟机中安装Kali。
 
设想调查人员正在溯源一起攻击事件。他们将发现“Front Gun”的IP，可能的话，将最终控制这台设备，或攻陷后监控入栈IP连接。这些 IP 地址都以VPN作为退出节点，涉及到成百上千的用户。 The VPN provider is in a neutral country that does not keep logs or have access to credit card information. Even if by some miracle, they choose to cooperate with law enforcement and spy on their users, they will hand over a public hotspot IP address likely located in another country and used by thousands of users every day. This is all a long series of regressions, making the investigation less and less rewarding until eventually the cost outweighs the damage and (hopefully) the case is dropped.
